<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Konfigur√°tor | Cakes by DT</title>
    <style>
        :root { --primary: #ad1457; --bg: #fff5f8; --border: #fce7f3; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); display: flex; justify-content: center; padding: 20px; margin: 0; }
        .karta { background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 650px; display: flex; flex-direction: column; }
        
        .header { text-align: center; margin-bottom: 20px; }
        .logo-img { max-width: 130px; border-radius: 50%; border: 3px solid var(--border); }
        h1 { color: var(--primary); margin: 5px 0; }
        
        .galerie { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; }
        .galerie img { width: 100%; height: 100px; object-fit: cover; border-radius: 12px; border: 1px solid var(--border); }

        /* 3D SEKCE */
        .scena-wrapper { background: #fff; border: 2px dashed #f9a8d4; border-radius: 20px; margin: 10px 0; padding: 30px 10px; display: flex; flex-direction: column; align-items: center; position: relative; }
        .scena { height: 300px; perspective: 1000px; display: flex; align-items: center; justify-content: center; width: 100%; }
        .dort-telo { position: relative; width: 160px; transform-style: preserve-3d; transition: transform 0.1s linear; }
        .vyska-info { background: var(--primary); color: white; padding: 6px 15px; border-radius: 20px; font-weight: bold; font-size: 13px; margin-bottom: 10px; z-index: 10; }

        /* 3D VRSTVY */
        .vrstva { position: absolute; width: 100%; height: 10px; transform-style: preserve-3d; bottom: var(--bottom); }
        .segment { position: absolute; width: var(--segW); height: 10px; left: 50%; margin-left: calc(var(--segW)/-2); background: linear-gradient(to right, rgba(0,0,0,0.1), transparent, rgba(0,0,0,0.1)), var(--color); }
        .vicko { position: absolute; width: var(--w); height: var(--w); background: var(--topColor); border-radius: 50%; left: 50%; top: 50%; transform: translate(-50%, -50%) rotateX(90deg) translateZ(5px); transform-style: preserve-3d; }
        
        /* DEKORACE */
        .deco-3d { position: absolute; width: 24px; height: 30px; transform-style: preserve-3d; transform-origin: center bottom; }
        .deco-face { position: absolute; width: 100%; height: 100%; background-size: contain; background-repeat: no-repeat; transform-origin: bottom center; }
        .face-2 { transform: rotateY(90deg); }

        /* FORMUL√Å≈ò */
        .sekce { background: #fffcfd; padding: 15px; border-radius: 15px; border: 1px solid var(--border); margin-bottom: 15px; }
        h3 { color: var(--primary); font-size: 15px; margin: 0 0 10px; border-bottom: 1px solid #f9a8d4; padding-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
        .flex { display: flex; gap: 10px; margin-bottom: 10px; }
        .flex > div { flex: 1; }
        label { display: block; font-size: 11px; font-weight: bold; color: var(--primary); margin-bottom: 4px; }
        input, select, textarea { width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #f9a8d4; box-sizing: border-box; font-family: inherit; font-size: 13px; }
        
        .moznos-radek { display: flex; align-items: center; gap: 8px; margin-bottom: 5px; font-size: 13px; }
        .tahlo { width: 80%; accent-color: var(--primary); cursor: pointer; margin-top: 10px; }
        .btn { width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 15px; cursor: pointer; font-weight: bold; font-size: 16px; margin-top: 10px; }
    </style>
</head>
<body>

<div class="karta">
    <div class="header">
        <img src="https://via.placeholder.com/150?text=LOGO+DT" id="hlavni-logo" alt="Logo" class="logo-img">
        <h1>Cakes by DT</h1>
    </div>

    <div class="sekce">
        <h3>üë§ Kontakt</h3>
        <div class="flex">
            <input type="text" id="jmeno" placeholder="Jm√©no">
            <input type="tel" id="telefon" placeholder="Telefon">
        </div>
        <input type="email" id="email" placeholder="E-mail" style="margin-top:5px">
    </div>

    <div class="sekce">
        <h3>üéÇ Slo≈æen√≠ dortu</h3>
        <div class="flex">
            <div>
                <label>Vrstvy korpusu</label>
                <select id="patra" onchange="kresliDort()">
                    <option value="2">2 vrstvy</option>
                    <option value="3">3 vrstvy</option>
                    <option value="4" selected>4 vrstvy</option>
                    <option value="5">5 vrstev</option>
                </select>
            </div>
            <div>
                <label>Typ korpusu</label>
                <select id="korpus" onchange="kresliDort()">
                    <option value="#4e342e">ƒåokol√°dov√Ω</option>
                    <option value="#f3e5ab" selected>Svƒõtl√Ω pi≈°kot</option>
                </select>
            </div>
        </div>
        <div class="flex">
            <div>
                <label>Z√°klad kr√©mu</label>
                <select id="krem" onchange="kresliDort()">
                    <option value="#ffffff">Mascarpone (B√≠l√Ω)</option>
                    <option value="#fffde7">Vanilkov√Ω (≈Ωlut√Ω)</option>
                    <option value="#f8bbd0">Ovocn√Ω (R≈Ø≈æov√Ω)</option>
                </select>
            </div>
            <div>
                <label>Ovoce v kr√©mu</label>
                <select id="ovoce-vnitrek" onchange="kresliDort()">
                    <option value="none">Bez ovoce</option>
                    <option value="jahody">Jahody</option>
                    <option value="boruvky">Bor≈Øvky</option>
                    <option value="maliny">Maliny</option>
                </select>
            </div>
        </div>
    </div>

    <div class="sekce" style="background: #fff0f5; border: 1.5px solid var(--primary);">
        <h3>üé® Vnƒõj≈°√≠ vzhled</h3>
        <div class="flex">
            <div style="flex: 2;">
                <label>Barva pot≈ôen√≠ (venkovn√≠ kr√©m)</label>
                <select id="vnejsi-barva" onchange="kresliDort()">
                    <option value="naked" selected>Nahat√Ω dort (viditeln√Ω ≈ôez)</option>
                    <option value="#ffffff">B√≠l√°</option>
                    <option value="#fce7f3">R≈Ø≈æov√°</option>
                    <option value="#4e342e">ƒåokol√°dov√°</option>
                </select>
            </div>
            <div>
                <label>Ovoce na vr≈°ek</label>
                <select id="ovoce-vrsek" onchange="kresliDort()">
                    <option value="jahoda">Jahody</option>
                    <option value="boruvka">Bor≈Øvky</option>
                    <option value="mix">Mix oboj√≠</option>
                    <option value="none">Bez ovoce</option>
                </select>
            </div>
        </div>
    </div>

    <div class="scena-wrapper">
        <div class="vyska-info">Celkov√° v√Ω≈°ka: <span id="cm-vyska">0</span> cm</div>
        <div class="scena"><div class="dort-telo" id="vizual"></div></div>
        <input type="range" min="0" max="360" value="45" class="tahlo" oninput="otoc(this.value)">
    </div>

    <div class="sekce">
        <h3>üéÅ Dopl≈àky a pozn√°mka</h3>
        <div class="flex">
            <div class="moznos-radek"><input type="checkbox" id="cedule"> <span>Z√°pich</span></div>
            <div class="moznos-radek"><input type="checkbox" id="krabice"> <span>Krabice</span></div>
        </div>
        <textarea id="poznamka" rows="2" placeholder="Dal≈°√≠ p≈ô√°n√≠ (nap≈ô. barva zdoben√≠, n√°pis...)"></textarea>
    </div>

    <button class="btn" onclick="odeslat()">ODESLAT POPT√ÅVKU</button>
</div>

<script>
    let rotY = 45;
    const assets = {
        jahoda: `url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 120"><path d="M50,115 C20,115 5,85 5,55 C5,25 25,10 50,10 C75,10 95,25 95,55 C95,85 80,115 50,115 Z" fill="%23ff4d4d"/><path d="M50,15 L35,-5 L50,5 L65,-5 Z" fill="%232e7d32"/></svg>')`,
        boruvka: `url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="%233f51b5"/><circle cx="50" cy="50" r="15" fill="%231a237e" opacity="0.5"/></svg>')`
    };

    function otoc(v) {
        rotY = v;
        document.getElementById('vizual').style.transform = `rotateX(-20deg) rotateY(${v}deg)`;
    }

    function kresliDort() {
        const plocha = document.getElementById('vizual');
        const pCount = parseInt(document.getElementById('patra').value);
        const cK = document.getElementById('korpus').value;
        const cN_base = document.getElementById('krem').value;
        const vnejsiBarva = document.getElementById('vnejsi-barva').value;
        const ovVrsek = document.getElementById('ovoce-vrsek').value;
        const ovVnitrek = document.getElementById('ovoce-vnitrek').value;
        
        plocha.innerHTML = "";
        const sirka = 160;
        const vyskaPX = 10;
        const pocetVrstev = pCount * 2; 
        document.getElementById('cm-vyska').innerText = (pocetVrstev * 1.5).toFixed(1);

        // Barva vnit≈ôn√≠ho kr√©mu s "kousky ovoce"
        let cN = cN_base;
        if(ovVnitrek !== 'none' && vnejsiBarva === 'naked') {
            if(ovVnitrek === 'jahody' || ovVnitrek === 'maliny') cN = `radial-gradient(circle, ${cN_base} 70%, #ff80ab 100%)`;
            if(ovVnitrek === 'boruvky') cN = `radial-gradient(circle, ${cN_base} 70%, #9fa8da 100%)`;
        }

        for (let i = 0; i < pocetVrstev; i++) {
            const v = document.createElement('div');
            v.className = 'vrstva';
            v.style.setProperty('--bottom', (i * vyskaPX) + 'px');
            
            const barvaVrstvy = (vnejsiBarva === "naked") ? (i % 2 === 0 ? cK : cN) : vnejsiBarva;
            v.style.setProperty('--color', barvaVrstvy);
            v.style.setProperty('--segW', (Math.PI * sirka / 32 + 2) + 'px');

            for (let j = 0; j < 32; j++) {
                const s = document.createElement('div');
                s.className = 'segment';
                s.style.transform = `rotateY(${j * 11.25}deg) translateZ(${sirka/2}px)`;
                v.appendChild(s);
            }

            if (i === pocetVrstev - 1) {
                const vicko = document.createElement('div');
                vicko.className = 'vicko';
                vicko.style.setProperty('--w', sirka + 'px');
                vicko.style.setProperty('--topColor', (vnejsiBarva === "naked") ? cN_base : vnejsiBarva);
                
                if (ovVrsek !== 'none') {
                    const r = sirka / 3.5;
                    [[0,0], [r,0], [-r,0], [0,r], [0,-r]].forEach((pos, idx) => {
                        const d = document.createElement('div');
                        d.className = 'deco-3d';
                        d.style.left = (sirka/2 + pos[0] - 12) + 'px';
                        d.style.top = (sirka/2 + pos[1] - 15) + 'px';
                        d.style.transform = `rotateX(-90deg) translateZ(2px)`;
                        
                        let img = assets.jahoda;
                        if(ovVrsek === 'boruvka') img = assets.boruvka;
                        if(ovVrsek === 'mix' && idx % 2 === 0) img = assets.boruvka;

                        const f1 = document.createElement('div'); f1.className = 'deco-face'; f1.style.backgroundImage = img;
                        const f2 = document.createElement('div'); f2.className = 'deco-face face-2'; f2.style.backgroundImage = img;
                        d.appendChild(f1); d.appendChild(f2); vicko.appendChild(d);
                    });
                }
                v.appendChild(vicko);
            }
            plocha.appendChild(v);
        }
        otoc(rotY);
    }

    function odeslat() {
        const jmeno = document.getElementById('jmeno').value;
        const body = `Popt√°vka od: ${jmeno}%0AV√Ω≈°ka: ${document.getElementById('cm-vyska').innerText} cm%0AVnit≈ôek: ${document.getElementById('ovoce-vnitrek').value}%0AVr≈°ek: ${document.getElementById('ovoce-vrsek').value}%0APozn√°mka: ${document.getElementById('poznamka').value}`;
        window.location.href = `mailto:domii.trnovska@seznam.cz?subject=Dort_Poptavka&body=${body}`;
    }

    window.onload = kresliDort;
</script>

</body>
</html>
